# T07-Ciclo de vida de la Activity y arquitectura MVVM

![Activity Lifecycle](img/T07/activity_lifecycle.png)

## IntroducciÃ³n

El ciclo de vida de una aplicaciÃ³n Android es bastante diferente al ciclo de vida de una aplicaciÃ³n en otros S.O., como podrÃ­a ser Windows. La mayor diferencia es que, en Android el ciclo de vida estÃ¡ controlado principalmente por el sistema y no directamente por el usuario.

Es importante entender quÃ© ocurre en un dispositivo mÃ³vil y lo peculiar del sistema operativo respecto a uno de escritorio como Windows.

Para ello vamos a ver los siguientes vÃ­deos:

* [https://www.youtube.com/watch?v=stnLbKk0wak](https://www.youtube.com/watch?v=stnLbKk0wak)
* [https://www.youtube.com/watch?v=hbzzZ-orRWg](https://www.youtube.com/watch?v=hbzzZ-orRWg)

Para resolver la problemÃ¡tica y que el usuario no pierda en ningÃºn momento su experiencia, el programador tiene que encargarse de evitar la pÃ©rdida de datos, para ello, disponemos de una serie de eventos que nos permite controlar el ciclo de vida de la Activity para que, por ejemplo:

* No falle si el usuario recibe una llamada telefÃ³nica o cambia a otra app mientras usa la tuya.
* No consuma recursos valiosos del sistema cuando el usuario no la use de forma activa.
* No pierda el progreso del usuario si este abandona tu app y regresa a ella posteriormente.
* No falle ni pierda el progreso del usuario cuando se gire la pantalla entre la orientaciÃ³n horizontal y la vertical.

Cada vez que una actividad cambia de estado se van a generar eventos que podrÃ¡n ser capturados por ciertos mÃ©todos de la actividad. A continuaciÃ³n, se muestra un esquema que ilustra los mÃ©todos que capturan estos eventos.

![Activity Lifecycle](img/T07/activity_lifecycle.png)

Puedes ver el siguiente vÃ­deo para entender mejor el ciclo de vida: [https://www.youtube.com/watch?v=E1vAobJ8Fxo](https://www.youtube.com/watch?v=E1vAobJ8Fxo)

Ojo: No confundir el ciclo de vida de la Activity con el ciclo de vida del Composable, que es diferente aunque dependiente del primero. [https://developer.android.com/develop/ui/compose/lifecycle](https://developer.android.com/develop/ui/compose/lifecycle)

![Composable Lifecycle](img/T07/lifecycle-composition.png)

-----

## Ejercicios

Este es un tema muy complejo, por lo que vamos a hacerlo un poco mÃ¡s **amigable** siguiendo el training oficial de Android: [https://developer.android.com/courses/android-basics-compose/course](https://developer.android.com/courses/android-basics-compose/course). Esto corresponde con parte de la **Unit 4: Navigation and app architecture**.

De momento nos vamos a centrar sÃ³lo en el **Pathway 1: Architecture components** [https://developer.android.com/courses/pathways/android-basics-compose-unit-4-pathway-1](https://developer.android.com/courses/pathways/android-basics-compose-unit-4-pathway-1) que ya tiene una duraciÃ³n estimada mÃ¡s que adecuada.

Cuando lleguemos a los codelabs, para traernos ese trabajo a nuestra organizaciÃ³n, realizaremos la siguiente secuencia de acciones. BÃ¡sicamente clonamos el repo oficial rama starter (que es la que nos piden), eliminamos su historial git, inicializamos un nuevo repo git, creamos el repo en nuestra organizaciÃ³n y hacemos el primer push.

```bash
git clone --branch starter https://github.com/google-developer-training/basic-android-kotlin-compose-training-dessert-clicker
cd basic-android-kotlin-compose-training-dessert-clicker
rm -rf .git     
git init -b main
git add .
git commit -m "Initial commit from Codelab starter"
gh repo create Movil2025SergioContrerasLopez/basic-android-kotlin-compose-training-dessert-clicker --private --source=. --remote=origin
git push -u origin main
```
> [!NOTE]
> En PowerShell rm nos fallarÃ¡. Siempre podemos borrar manualmente el .git o aprendernos su comando Remove-Item
> Recuerda tambiÃ©n los git config user.name y user.email si es necesario despuÃ©s del init

Este codelab nos servirÃ¡ tambiÃ©n para hacer la prÃ¡ctica de **Add a ViewModel to Dessert Clicker**.

> [!NOTE]
> Si bien con sÃ³lo se pide entregar dos de los codelabs, es **totalmente imprescindible** realizar del de **ViewModel and State in Compose**.
> A nivel de contenidos es probablemente el mÃ¡s importante.

ðŸš© **TLDR** ðŸš©: La entrega consiste en un Ãºnico repo en el que se completan los codelabs **Stages of the Activity lifecycle** y **Add a ViewModel to Dessert Clicker**. Es importante que la commit history sea clara y muestre el progreso del trabajo realizado.

En cualquier caso, se espera que realicÃ©is todos los codelabs de esta Unit 4, al menos del **Pathway 1: Architecture components**.

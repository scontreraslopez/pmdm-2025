# T07-Ciclo de vida de la Activity y arquitectura MVVM

![Activity Lifecycle](img/T07/activity_lifecycle.png)

## Introducci√≥n

El ciclo de vida de una aplicaci√≥n Android es bastante diferente al ciclo de vida de una aplicaci√≥n en otros S.O., como podr√≠a ser Windows. La mayor diferencia es que, en Android el ciclo de vida est√° controlado principalmente por el sistema y no directamente por el usuario.

Es importante entender qu√© ocurre en un dispositivo m√≥vil y lo peculiar del sistema operativo respecto a uno de escritorio como Windows.

Para ello vamos a ver los siguientes v√≠deos:

* [https://www.youtube.com/watch?v=stnLbKk0wak](https://www.youtube.com/watch?v=stnLbKk0wak)
* [https://www.youtube.com/watch?v=hbzzZ-orRWg](https://www.youtube.com/watch?v=hbzzZ-orRWg)

Para resolver la problem√°tica y que el usuario no pierda en ning√∫n momento su experiencia, el programador tiene que encargarse de evitar la p√©rdida de datos, para ello, disponemos de una serie de eventos que nos permite controlar el ciclo de vida de la Activity para que, por ejemplo:

* No falle si el usuario recibe una llamada telef√≥nica o cambia a otra app mientras usa la tuya.
* No consuma recursos valiosos del sistema cuando el usuario no la use de forma activa.
* No pierda el progreso del usuario si este abandona tu app y regresa a ella posteriormente.
* No falle ni pierda el progreso del usuario cuando se gire la pantalla entre la orientaci√≥n horizontal y la vertical.

Cada vez que una actividad cambia de estado se van a generar eventos que podr√°n ser capturados por ciertos m√©todos de la actividad. A continuaci√≥n, se muestra un esquema que ilustra los m√©todos que capturan estos eventos.

![Activity Lifecycle](img/T07/activity_lifecycle.png)

Puedes ver el siguiente v√≠deo para entender mejor el ciclo de vida: [https://www.youtube.com/watch?v=E1vAobJ8Fxo](https://www.youtube.com/watch?v=E1vAobJ8Fxo)

Ojo: No confundir el ciclo de vida de la Activity con el ciclo de vida del Composable, que es diferente aunque dependiente del primero. [https://developer.android.com/develop/ui/compose/lifecycle](https://developer.android.com/develop/ui/compose/lifecycle)

![Composable Lifecycle](img/T07/lifecycle-composition.png)

-----

## Ejercicios

Este es un tema muy complejo, por lo que vamos a hacerlo un poco m√°s **amigable** siguiendo el training oficial de Android: [https://developer.android.com/courses/android-basics-compose/course](https://developer.android.com/courses/android-basics-compose/course). Esto corresponde con parte de la **Unit 4: Navigation and app architecture**.

De momento nos vamos a centrar s√≥lo en el **Pathway 1: Architecture components** [https://developer.android.com/courses/pathways/android-basics-compose-unit-4-pathway-1](https://developer.android.com/courses/pathways/android-basics-compose-unit-4-pathway-1) que ya tiene una duraci√≥n estimada m√°s que adecuada.

Cuando lleguemos a los codelabs, para traernos ese trabajo a nuestra organizaci√≥n, realizaremos la siguiente secuencia de acciones. B√°sicamente clonamos el repo oficial rama starter (que es la que nos piden), eliminamos su historial git, inicializamos un nuevo repo git, creamos el repo en nuestra organizaci√≥n y hacemos el primer push.

```bash
git clone --branch starter https://github.com/google-developer-training/basic-android-kotlin-compose-training-dessert-clicker T07-Ejercicios
cd T07-Ejercicios
rm -rf .git     
git init -b main
git add .
git commit -m "Initial commit from Codelab starter"
gh repo create Movil2025SergioContrerasLopez/T07-Ejercicios --private --source=. --remote=origin
git push -u origin main
```
> [!NOTE]
> En PowerShell rm nos fallar√°. Siempre podemos borrar manualmente el .git o aprendernos su comando Remove-Item
> Recuerda tambi√©n los git config user.name y user.email si es necesario despu√©s del init

Este codelab nos servir√° tambi√©n para hacer la pr√°ctica de **Add a ViewModel to Dessert Clicker**.

üö© **TLDR** üö©: La entrega consiste en un √∫nico repo en el que se completan los codelabs **Stages of the Activity lifecycle** y **Add a ViewModel to Dessert Clicker**. Es importante que la commit history sea clara y muestre el progreso del trabajo realizado.

En cualquier caso, se espera que realic√©is todos los codelabs de esta Unit 4, al menos del **Pathway 1: Architecture components**.
